<h2>[% gettext("Products") %]</h2>
<table>
<tbody>
	<tr>
	<td>[% gettext("By group") %]:</td>
	<td>
	<form method="get" action="javascript:loadContent('content.cgi','contentcgi');" name="contentcgi">
	<p>
	<input type='hidden' name='module' value='[% module %]' />
	<input type='hidden' name='action' value='showall' />
	<select name="groupid" class="medium" onchange="submit()" >
	<option value='-1'>-- [% gettext("All groups") %] --</option>
	[% FOREACH key IN productgroups.keys.sort %]
	[% data = productgroups.$key %]
		<option value="[% data.id %]">[% data.name %]</option>
	[% END %]
	</select>
	<input type="submit" value=">" />
	</p>

	<noscript>
  		<p><input type="submit" value="[% gettext("Show") %]" /></p>
	</noscript>
	</form>
	
	</td>
	<td>[% gettext("By barcode") %]</td>
	<td>
	<form method="post" name="barcodeform">
	<input type='hidden' name='module' value='[% module %]' />
	<input type="hidden" name="subaction" value="ean" />
	<input name="barcode" class="large" />
	<input type="submit" value="[% gettext("Add") %]" />
	</form>
	</td>		
	<form method="post" name="productcodeform">
	<input type='hidden' name='module' value='[% module %]' />
	<input type="hidden" name="subaction" value="productcode" />
	<td>[% gettext("By code") %]: </td>
	<td><input name="code" class="large" />
	<input type="submit" value="[% gettext("Add") %]" />
	</form>
	</td>
	</tr>
</tbody>
</table>

<div id='contentcgi'>
</div>

[% edittext = gettext("Edit") %]
[% deltext = gettext("Delete") %]
[% delconfirmtext = gettext("Delete product from database?") %]
[% FOREACH g IN productspergroup.keys.sort %]
	[% group = productspergroup.$g %]
	<h3>[% group.name %]</h3>
	<table>
	<thead>
	<tr>
	<th>[% gettext("Code") %]</th>
	<th>[% gettext("Name") %]</th>
	<th>[% gettext("Manufacturer") %]</th>
	<th>[% gettext("Purchase price") %]</th>
	<th>[% gettext("Sell price") %]</th>
	<th>[% gettext("VAT class") %]</th>
	<th>[% gettext("In storage") %]</th>
	<th>[% gettext("Row value") %]</th>
	<th class="icon">[% gettext("Open") %]</th>
	<th class="icon">[% gettext("Delete") %]</th>
	</tr>
	</thead>
	<tbody class="rowdata">
	[% odd = 0 %]
	[% products = productspergroup.$g.products %]
	[% FOREACH key IN products.keys.sort %]
		[% product  = products.$key %]
		[% IF odd == 1 %]
			<tr class="odd">
			[% odd = 0 %]
		[% ELSE %]
			<tr class="even">
			[% odd = 1 %]
		[% END %]

		<td>[% product.code %]</td>
		<td>[% product.name %]</td>
		<td>[% product.manufacturer_name %]</td>
		<td>[% product.purchase %]</td>
		<td>[% product.sell %]</td>
		<td>[% product.vatclass %]</td>
		<td>[% product.in_store %]</td>
		<td>[% product.row_total_value %]</td>
		<td class="center">
		<form action="" method="post">
		<p>
		<input type="hidden" name="module" value="[% module %]" />
		<input type="hidden" name="action" value="edit" />
		<input type="hidden" name="type" value="products" />
		<input type="hidden" name="id" value="[% product.id %]" />
		<input type="image" name="submit" src="themes/[% theme %]/icon/32x32/actions/document-open.png" alt="[% edittext %]" />
		</p>
		</form>
		</td>
		<td class="center">
		<form action="" method="post">
		<p>
		<input type="hidden" name="module" value="[% module %]" />
		<input type="hidden" name="action" value="delete" />
		<input type="hidden" name="type" value="products" />
		<input type="hidden" name="id" value="[% product.id %]" />
		<input type="image" name="submit" src="themes/[% theme %]/icon/32x32/actions/edit-delete.png" alt="[% deltext %]"
			onclick="return confirm('[% delconfirmtext %]')" />
		 </p>
		</form>
		</td>
		</tr>
	[% END %]
	<tr><th colspan="6" class='right'>[% gettext("Group total value:") %]</th><th>[% group.group_total_value %]</th><th colspan="2">&nbsp;</th></tr>
	</tbody>
	[% IF loop.last %]
		<tr><td colspan='6'>[% gettext("Total storage value") %] [% storagetotalvalue %]</td></tr>
	[% END %]
	</table>
[% END %]

